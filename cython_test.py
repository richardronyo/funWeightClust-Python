import numpy as np
from imahalanobis import C_imahalanobis

if __name__ == "__main__":
# Test values
    p = 7
    N = 9
    di = 7

    # Initialize test arrays
    x = np.array([[  7.097262,   8.1572632,  49.29277143, 100.964868,   0.5893732,  -2.830650,   1.7175008],
                [ 24.462168,  49.3508728,  42.66487073,  94.874986,   6.6944494,  10.344421,  -0.2627107],
                [ -5.346587,  -0.3830047,  51.42272710, 100.275937,  -3.9766077,   2.551451,  -2.4359856],
                [ -2.904262,  -0.4063338,  84.43214974,   2.271619,  41.4284958,   1.970657,   0.3859413],
                [ -4.119764,   2.9583553,  77.79200027, -16.523747,  46.9801614,  -4.316811, -11.7843803],
                [  6.906815,   5.6165627,  73.56002331,  -6.523302,  46.3955478,   7.016178,   5.3404726],
                [ -3.044057,  18.8220580,   5.35340979,  77.968814,  -0.7312554,   1.398231, 102.6986097],
                [ 11.925297,  22.0466268,   0.04847252,  74.661182,  -2.4172216,  -2.200714,  95.4039520],
                [  1.742587,  15.8331692,  -0.25938706,  78.530719,   2.5058592,  -4.038033, 101.5510831]], dtype=np.float64)

    muk = np.array([ 4.500557, 13.797230, 43.224187, 49.688508, 17.697405,  1.100446, 34.791545], dtype=np.float64)

    wk = np.array([[1.889822, 1.157522, 0.244088, 0.01575233, 0.00000000, 0.000000000, 0.00000000],
                [0.000000, 2.048369, 1.769107, 0.41244527, 0.00363327, 0.000000000, 0.00000000],
                [0.000000, 0.000000, 2.231646, 2.18744529, 0.26161906, 0.003334882, 0.00000000],
                [0.000000, 0.000000, 0.000000, 2.65119438, 1.90153286, 0.322789894, 0.01122857],
                [0.000000, 0.000000, 0.000000, 0.00000000, 2.11784747, 1.554243874, 0.20772572],
                [0.000000, 0.000000, 0.000000, 0.00000000, 0.00000000, 1.736603755, 1.07164914],
                [0.000000, 0.000000, 0.000000, 0.00000000, 0.00000000, 0.000000000, 1.54263432]], dtype=np.float64)

    Qk = np.array([[-0.02497028,  0.03330785,  0.21336844,  0.1449470, -0.14457396, -0.53333721,  0.2158669],
                [-0.06781860,  0.04970990,  0.33408383,  0.1241929,  0.12676940,  0.51037675, -0.2845134],
                [ 0.30054123,  0.06523742, -0.10463081, -0.3225999,  0.14245342, -0.31407046,  0.3548243],
                [-0.35292733,  0.23444685, -0.02091416,  0.1564113, -0.01586174,  0.07711326, -0.3388005],
                [ 0.18514175, -0.06675278,  0.04565495, -0.1680347, -0.21639781,  0.13752427,  0.5653657],
                [ 0.01041464,  0.02382225,  0.07515458, -0.1604016, -0.10726662, -0.17843004, -0.6451456],
                [-0.37488123, -0.24828409,  0.06404145, -0.1437877,  0.21645631,  0.05559432,  0.3785713]], dtype=np.float64)

    aki = np.array([[0.009375081, 0.000000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000],
                    [0.000000000, 0.009375081, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000],
                    [0.000000000, 0.000000000, 0.05622032, 0.00000000, 0.00000000, 0.00000000, 0.00000000],
                    [0.000000000, 0.000000000, 0.00000000, 0.05622032, 0.00000000, 0.00000000, 0.00000000],
                    [0.000000000, 0.000000000, 0.00000000, 0.00000000, 0.05622032, 0.00000000, 0.00000000],
                    [0.000000000, 0.000000000, 0.00000000, 0.00000000, 0.00000000, 0.05622032, 0.00000000],
                    [0.000000000, 0.000000000, 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0.05622032]], dtype=np.float64)

    res = np.zeros(N, dtype=np.float64)
    # Call the C_imahalanobis function
    ans = C_imahalanobis(x, muk, wk, Qk, aki, p, N, di, res)

    # Print the result
    print("Result vector:")
    print(ans)